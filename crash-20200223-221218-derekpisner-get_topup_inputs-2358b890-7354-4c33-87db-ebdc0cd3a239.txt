Node: single_subject_dmri_ALGA.get_topup_inputs
Working directory: /private/tmp/work/single_subject_dmri_ALGA/get_topup_inputs

Node inputs:

b0_vols = [array([[[16.   , 13.5  , 11.   , ...,  0.   ,  0.   ,  0.   ],
        [13.5  , 13.   , 12.5  , ...,  5.5  ,  5.5  ,  0.   ],
        [11.   , 12.5  , 14.   , ..., 11.   , 11.   ,  0.   ],
        ...,
        [12.   , 12.5  , 13.   , ..., 13.25 , 13.5  ,  0.   ],
        [12.   , 12.5  , 13.   , ..., 12.   , 13.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[14.   , 12.5  , 11.   , ...,  0.   ,  0.   ,  0.   ],
        [13.   , 12.375, 11.75 , ...,  5.5  ,  5.75 ,  0.   ],
        [12.   , 12.25 , 12.5  , ..., 11.   , 11.5  ,  0.   ],
        ...,
        [13.   , 12.75 , 12.5  , ..., 12.25 , 13.25 ,  0.   ],
        [13.5  , 12.5  , 11.5  , ..., 11.75 , 13.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[12.   , 11.5  , 11.   , ...,  0.   ,  0.   ,  0.   ],
        [12.5  , 11.75 , 11.   , ...,  5.5  ,  6.   ,  0.   ],
        [13.   , 12.   , 11.   , ..., 11.   , 12.   ,  0.   ],
        ...,
        [14.   , 13.   , 12.   , ..., 11.25 , 13.   ,  0.   ],
        [15.   , 12.5  , 10.   , ..., 11.5  , 13.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 5.   ,  5.   ,  5.   , ...,  0.   ,  0.   ,  0.   ],
        [ 4.75 ,  5.25 ,  5.75 , ...,  3.375,  3.25 ,  0.   ],
        [ 4.5  ,  5.5  ,  6.5  , ...,  6.75 ,  6.5  ,  0.   ],
        ...,
        [ 7.   ,  6.75 ,  6.5  , ...,  6.5  ,  6.25 ,  0.   ],
        [ 7.5  ,  7.5  ,  7.5  , ...,  6.5  ,  6.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[14.   , 12.5  , 11.   , ...,  0.   ,  0.   ,  0.   ],
        [14.5  , 12.75 , 11.   , ...,  6.   ,  6.5  ,  0.   ],
        [15.   , 13.   , 11.   , ..., 12.   , 13.   ,  0.   ],
        ...,
        [14.   , 13.5  , 13.   , ..., 11.25 ,  9.5  ,  0.   ],
        [14.   , 13.   , 12.   , ..., 12.   , 11.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[13.   , 13.5  , 14.   , ...,  0.   ,  0.   ,  0.   ],
        [12.75 , 12.875, 13.   , ...,  5.5  ,  6.   ,  0.   ],
        [12.5  , 12.25 , 12.   , ..., 11.   , 12.   ,  0.   ],
        ...,
        [12.25 , 12.625, 13.   , ..., 12.5  , 11.5  ,  0.   ],
        [12.5  , 12.5  , 12.5  , ..., 11.75 , 11.5  ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[12.   , 14.5  , 17.   , ...,  0.   ,  0.   ,  0.   ],
        [11.   , 13.   , 15.   , ...,  5.   ,  5.5  ,  0.   ],
        [10.   , 11.5  , 13.   , ..., 10.   , 11.   ,  0.   ],
        ...,
        [10.5  , 11.75 , 13.   , ..., 13.75 , 13.5  ,  0.   ],
        [11.   , 12.   , 13.   , ..., 11.5  , 12.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 5.5  ,  5.75 ,  6.   , ...,  0.   ,  0.   ,  0.   ],
        [ 6.5  ,  5.875,  5.25 , ...,  3.125,  3.75 ,  0.   ],
        [ 7.5  ,  6.   ,  4.5  , ...,  6.25 ,  7.5  ,  0.   ],
        ...,
        [ 5.75 ,  5.75 ,  5.75 , ...,  6.5  ,  6.75 ,  0.   ],
        [ 6.   ,  5.75 ,  5.5  , ...,  6.75 ,  7.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[ 9.   , 11.   , 13.   , ...,  0.   ,  0.   ,  0.   ],
        [10.   , 11.25 , 12.5  , ...,  6.   ,  5.   ,  0.   ],
        [11.   , 11.5  , 12.   , ..., 12.   , 10.   ,  0.   ],
        ...,
        [13.5  , 13.   , 12.5  , ..., 11.75 , 12.5  ,  0.   ],
        [14.   , 12.5  , 11.   , ..., 10.5  , 11.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[11.   , 11.75 , 12.5  , ...,  0.   ,  0.   ,  0.   ],
        [12.25 , 12.125, 12.   , ...,  6.   ,  6.   ,  0.   ],
        [13.5  , 12.5  , 11.5  , ..., 12.   , 12.   ,  0.   ],
        ...,
        [13.   , 12.875, 12.75 , ..., 11.625, 11.5  ,  0.   ],
        [13.5  , 12.75 , 12.   , ..., 10.25 , 10.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[13.   , 12.5  , 12.   , ...,  0.   ,  0.   ,  0.   ],
        [14.5  , 13.   , 11.5  , ...,  6.   ,  7.   ,  0.   ],
        [16.   , 13.5  , 11.   , ..., 12.   , 14.   ,  0.   ],
        ...,
        [12.5  , 12.75 , 13.   , ..., 11.5  , 10.5  ,  0.   ],
        [13.   , 13.   , 13.   , ..., 10.   ,  9.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 5.5  ,  5.25 ,  5.   , ...,  0.   ,  0.   ,  0.   ],
        [ 5.5  ,  5.5  ,  5.5  , ...,  3.25 ,  3.75 ,  0.   ],
        [ 5.5  ,  5.75 ,  6.   , ...,  6.5  ,  7.5  ,  0.   ],
        ...,
        [ 6.25 ,  6.375,  6.5  , ...,  7.375,  8.   ,  0.   ],
        [ 6.   ,  6.   ,  6.   , ...,  7.   ,  8.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[16.   , 14.   , 12.   , ...,  0.   ,  0.   ,  0.   ],
        [14.5  , 13.25 , 12.   , ...,  6.25 ,  6.   ,  0.   ],
        [13.   , 12.5  , 12.   , ..., 12.5  , 12.   ,  0.   ],
        ...,
        [14.   , 13.   , 12.   , ..., 11.5  , 12.   ,  0.   ],
        [14.   , 12.5  , 11.   , ..., 11.   , 12.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[13.5  , 12.25 , 11.   , ...,  0.   ,  0.   ,  0.   ],
        [13.5  , 12.625, 11.75 , ...,  6.125,  6.25 ,  0.   ],
        [13.5  , 13.   , 12.5  , ..., 12.25 , 12.5  ,  0.   ],
        ...,
        [12.75 , 12.875, 13.   , ..., 11.125, 10.75 ,  0.   ],
        [12.5  , 12.5  , 12.5  , ..., 10.75 , 10.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[11.   , 10.5  , 10.   , ...,  0.   ,  0.   ,  0.   ],
        [12.5  , 12.   , 11.5  , ...,  6.   ,  6.5  ,  0.   ],
        [14.   , 13.5  , 13.   , ..., 12.   , 13.   ,  0.   ],
        ...,
        [11.5  , 12.75 , 14.   , ..., 10.75 ,  9.5  ,  0.   ],
        [11.   , 12.5  , 14.   , ..., 10.5  ,  8.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 5.5  ,  5.75 ,  6.   , ...,  0.   ,  0.   ,  0.   ],
        [ 5.75 ,  5.625,  5.5  , ...,  3.375,  3.   ,  0.   ],
        [ 6.   ,  5.5  ,  5.   , ...,  6.75 ,  6.   ,  0.   ],
        ...,
        [ 6.75 ,  6.   ,  5.25 , ...,  6.375,  6.75 ,  0.   ],
        [ 7.   ,  6.25 ,  5.5  , ...,  7.   ,  7.5  ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[13.   , 12.5  , 12.   , ...,  0.   ,  0.   ,  0.   ],
        [12.   , 12.25 , 12.5  , ...,  6.   ,  7.   ,  0.   ],
        [11.   , 12.   , 13.   , ..., 12.   , 14.   ,  0.   ],
        ...,
        [12.5  , 12.75 , 13.   , ..., 11.75 , 14.   ,  0.   ],
        [12.   , 12.   , 12.   , ..., 11.   , 13.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[13.   , 11.75 , 10.5  , ...,  0.   ,  0.   ,  0.   ],
        [12.   , 11.75 , 11.5  , ...,  6.5  ,  7.   ,  0.   ],
        [11.   , 11.75 , 12.5  , ..., 13.   , 14.   ,  0.   ],
        ...,
        [12.75 , 13.5  , 14.25 , ..., 11.625, 12.5  ,  0.   ],
        [12.5  , 12.75 , 13.   , ..., 10.75 , 11.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[13.   , 11.   ,  9.   , ...,  0.   ,  0.   ,  0.   ],
        [12.   , 11.25 , 10.5  , ...,  7.   ,  7.   ,  0.   ],
        [11.   , 11.5  , 12.   , ..., 14.   , 14.   ,  0.   ],
        ...,
        [13.   , 14.25 , 15.5  , ..., 11.5  , 11.   ,  0.   ],
        [13.   , 13.5  , 14.   , ..., 10.5  ,  9.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 5.   ,  5.5  ,  6.   , ...,  0.   ,  0.   ,  0.   ],
        [ 5.   ,  5.   ,  5.   , ...,  3.375,  3.25 ,  0.   ],
        [ 5.   ,  4.5  ,  4.   , ...,  6.75 ,  6.5  ,  0.   ],
        ...,
        [ 6.25 ,  6.125,  6.   , ...,  7.   ,  6.   ,  0.   ],
        [ 7.   ,  6.75 ,  6.5  , ...,  7.25 ,  6.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[13.   , 13.   , 13.   , ...,  0.   ,  0.   ,  0.   ],
        [13.5  , 13.   , 12.5  , ...,  5.25 ,  5.5  ,  0.   ],
        [14.   , 13.   , 12.   , ..., 10.5  , 11.   ,  0.   ],
        ...,
        [13.5  , 11.25 ,  9.   , ..., 12.   , 13.5  ,  0.   ],
        [15.   , 12.   ,  9.   , ..., 10.5  , 11.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[11.5  , 11.   , 10.5  , ...,  0.   ,  0.   ,  0.   ],
        [12.   , 11.5  , 11.   , ...,  5.5  ,  5.75 ,  0.   ],
        [12.5  , 12.   , 11.5  , ..., 11.   , 11.5  ,  0.   ],
        ...,
        [13.25 , 11.875, 10.5  , ..., 12.375, 12.75 ,  0.   ],
        [15.   , 12.75 , 10.5  , ..., 11.25 , 10.5  ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[10.   ,  9.   ,  8.   , ...,  0.   ,  0.   ,  0.   ],
        [10.5  , 10.   ,  9.5  , ...,  5.75 ,  6.   ,  0.   ],
        [11.   , 11.   , 11.   , ..., 11.5  , 12.   ,  0.   ],
        ...,
        [13.   , 12.5  , 12.   , ..., 12.75 , 12.   ,  0.   ],
        [15.   , 13.5  , 12.   , ..., 12.   , 10.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 4.5  ,  5.5  ,  6.5  , ...,  0.   ,  0.   ,  0.   ],
        [ 5.   ,  5.5  ,  6.   , ...,  3.25 ,  3.   ,  0.   ],
        [ 5.5  ,  5.5  ,  5.5  , ...,  6.5  ,  6.   ,  0.   ],
        ...,
        [ 5.5  ,  5.875,  6.25 , ...,  6.5  ,  6.5  ,  0.   ],
        [ 4.5  ,  5.   ,  5.5  , ...,  7.25 ,  7.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[10.   , 10.   , 10.   , ...,  0.   ,  0.   ,  0.   ],
        [11.   , 11.25 , 11.5  , ...,  7.   ,  7.5  ,  0.   ],
        [12.   , 12.5  , 13.   , ..., 14.   , 15.   ,  0.   ],
        ...,
        [14.5  , 14.   , 13.5  , ..., 13.   , 14.   ,  0.   ],
        [14.   , 13.5  , 13.   , ..., 12.5  , 14.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[11.   , 12.   , 13.   , ...,  0.   ,  0.   ,  0.   ],
        [12.   , 12.5  , 13.   , ...,  6.25 ,  6.75 ,  0.   ],
        [13.   , 13.   , 13.   , ..., 12.5  , 13.5  ,  0.   ],
        ...,
        [13.5  , 13.   , 12.5  , ..., 12.125, 12.5  ,  0.   ],
        [13.5  , 12.75 , 12.   , ..., 11.75 , 12.5  ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[12.   , 14.   , 16.   , ...,  0.   ,  0.   ,  0.   ],
        [13.   , 13.75 , 14.5  , ...,  5.5  ,  6.   ,  0.   ],
        [14.   , 13.5  , 13.   , ..., 11.   , 12.   ,  0.   ],
        ...,
        [12.5  , 12.   , 11.5  , ..., 11.25 , 11.   ,  0.   ],
        [13.   , 12.   , 11.   , ..., 11.   , 11.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 7.5  ,  7.   ,  6.5  , ...,  0.   ,  0.   ,  0.   ],
        [ 7.   ,  6.5  ,  6.   , ...,  2.875,  2.75 ,  0.   ],
        [ 6.5  ,  6.   ,  5.5  , ...,  5.75 ,  5.5  ,  0.   ],
        ...,
        [ 6.   ,  5.75 ,  5.5  , ...,  6.375,  5.75 ,  0.   ],
        [ 7.   ,  6.25 ,  5.5  , ...,  6.5  ,  6.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[13.   , 13.   , 13.   , ...,  0.   ,  0.   ,  0.   ],
        [12.   , 12.25 , 12.5  , ...,  6.25 ,  5.5  ,  0.   ],
        [11.   , 11.5  , 12.   , ..., 12.5  , 11.   ,  0.   ],
        ...,
        [12.5  , 12.25 , 12.   , ..., 11.   , 12.5  ,  0.   ],
        [11.   , 11.   , 11.   , ..., 12.5  , 13.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[11.5  , 12.75 , 14.   , ...,  0.   ,  0.   ,  0.   ],
        [11.   , 12.   , 13.   , ...,  6.125,  5.75 ,  0.   ],
        [10.5  , 11.25 , 12.   , ..., 12.25 , 11.5  ,  0.   ],
        ...,
        [13.25 , 12.375, 11.5  , ..., 11.375, 12.5  ,  0.   ],
        [11.5  , 10.75 , 10.   , ..., 12.25 , 12.5  ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[10.   , 12.5  , 15.   , ...,  0.   ,  0.   ,  0.   ],
        [10.   , 11.75 , 13.5  , ...,  6.   ,  6.   ,  0.   ],
        [10.   , 11.   , 12.   , ..., 12.   , 12.   ,  0.   ],
        ...,
        [14.   , 12.5  , 11.   , ..., 11.75 , 12.5  ,  0.   ],
        [12.   , 10.5  ,  9.   , ..., 12.   , 12.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 7.5  ,  6.75 ,  6.   , ...,  0.   ,  0.   ,  0.   ],
        [ 7.   ,  6.625,  6.25 , ...,  3.25 ,  3.25 ,  0.   ],
        [ 6.5  ,  6.5  ,  6.5  , ...,  6.5  ,  6.5  ,  0.   ],
        ...,
        [ 6.5  ,  6.125,  5.75 , ...,  5.875,  5.75 ,  0.   ],
        [ 6.   ,  6.5  ,  7.   , ...,  6.   ,  6.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]]), array([[[10.   , 13.   , 16.   , ...,  0.   ,  0.   ,  0.   ],
        [11.5  , 13.75 , 16.   , ...,  6.   ,  6.5  ,  0.   ],
        [13.   , 14.5  , 16.   , ..., 12.   , 13.   ,  0.   ],
        ...,
        [10.   , 11.75 , 13.5  , ..., 12.25 , 12.   ,  0.   ],
        [11.   , 12.   , 13.   , ..., 12.   , 12.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[11.5  , 11.75 , 12.   , ...,  0.   ,  0.   ,  0.   ],
        [12.25 , 12.375, 12.5  , ...,  6.   ,  6.75 ,  0.   ],
        [13.   , 13.   , 13.   , ..., 12.   , 13.5  ,  0.   ],
        ...,
        [11.   , 12.125, 13.25 , ..., 11.875, 11.25 ,  0.   ],
        [11.5  , 11.5  , 11.5  , ..., 11.5  , 11.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[13.   , 10.5  ,  8.   , ...,  0.   ,  0.   ,  0.   ],
        [13.   , 11.   ,  9.   , ...,  6.   ,  7.   ,  0.   ],
        [13.   , 11.5  , 10.   , ..., 12.   , 14.   ,  0.   ],
        ...,
        [12.   , 12.5  , 13.   , ..., 11.5  , 10.5  ,  0.   ],
        [12.   , 11.   , 10.   , ..., 11.   , 10.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       ...,

       [[ 6.5  ,  6.25 ,  6.   , ...,  0.   ,  0.   ,  0.   ],
        [ 6.   ,  6.125,  6.25 , ...,  3.625,  3.75 ,  0.   ],
        [ 5.5  ,  6.   ,  6.5  , ...,  7.25 ,  7.5  ,  0.   ],
        ...,
        [ 6.75 ,  6.125,  5.5  , ...,  4.875,  5.25 ,  0.   ],
        [ 6.   ,  5.75 ,  5.5  , ...,  5.   ,  5.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]],

       [[ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        ...,
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ],
        [ 0.   ,  0.   ,  0.   , ...,  0.   ,  0.   ,  0.   ]]])]
b0s = [0, 16, 32, 48, 64, 80, 96, 112, 128]
dwi_file = /private/tmp/work/20200223-195754_f9c22c81-6a52-4ea4-b47d-1f8a6a01d629/wf_multi_session_A00032875_multi_session/single_subject_dmri_ALGA/drop_outliers_fn/sub-A00032875_ses-ALGA_dwi_reor_RAS_res1mm_thinned.nii.gz
function_str = def topup_inputs_from_dwi_files(dwi_file, sesdir, spec_acqp, b0_vols, b0s, vol_legend):
    from collections import defaultdict
    import pkg_resources
    from shutil import copyfile
    import random

    """Create a datain spec and a slspec from a list of dwi files."""
    # Write the datain.txt file
    datain_lines = []
    spec_counts = defaultdict(int)

    if isinstance(spec_acqp, list):
        unique_encodings = []
        for k in range(len(spec_acqp)):
            unique_encodings.extend([j for j in list(set([float(i) for i in spec_acqp[k].split(' ')])) if (j == 1.0) or (j == -1.0)])
    else:
        unique_encodings = [j for j in list(set([float(i) for i in spec_acqp.split(' ')])) if (j == 1.0) or (j == -1.0)]

    if len(unique_encodings) > 1:
        # Reverse phase encodings are present to susceptibility can be estimated via topup
        susceptibility_args = '--estimate_move_by_susceptibility'
    else:
        susceptibility_args = ''

    dwi_img = nib.load(dwi_file)
    imain_data = []
    ix = 0
    for b0_vol in b0_vols:
        num_trs = 1 if len(b0_vol.shape) < 4 else b0_vol.shape[3]
        if vol_legend:
            vol_legend_consec = [sum(vol_legend[:i+1]) for i in range(len(vol_legend))]
            b0_level = next(x[0] for x in enumerate(vol_legend_consec) if x[1] > b0s[ix])
            datain_lines.extend([spec_acqp[b0_level]] * num_trs)
            spec_counts[spec_acqp[b0_level]] += num_trs
        else:
            datain_lines.extend([spec_acqp] * num_trs)
            spec_counts[spec_acqp] += num_trs
        imain_data.append(b0_vol)
        ix = ix + 1

    first_rev_ixs = [datain_lines.index(x) for x in set(datain_lines)]

    # Make a 4d series
    imain_output = sesdir + "/topup_imain.nii.gz"
    imain_data_4d = [imain_vol[..., np.newaxis] for imain_vol in [imain_data[i] for i in first_rev_ixs]]
    imain_img = nib.Nifti1Image(
        np.concatenate(imain_data_4d, 3), dwi_img.affine, dwi_img.header
    )
    assert imain_img.shape[3] == len(datain_lines)
    imain_img.to_filename(imain_output)

    # Write the datain text file
    datain_file_topup = sesdir + "/acqparams_topup.txt"
    with open(datain_file_topup, "w") as f:
        f.write("\n".join([datain_lines[i] for i in first_rev_ixs]))

    datain_file_eddy = sesdir + "/acqparams_eddy.txt"
    with open(datain_file_eddy, "w") as f:
        f.write("\n".join(datain_lines))

    example_b0 = b0_vols[0]
    topup_config = pkg_resources.resource_filename('dmriprep.config', "b02b0.cnf")
    topup_config_odd = pkg_resources.resource_filename('dmriprep.config', "b02b0_1.cnf")

    if 1 in (example_b0.shape[0] % 2, example_b0.shape[1] % 2, example_b0.shape[2] % 2):
        print("Using slower b02b0_1.cnf because an axis has an odd number of slices")
        topup_config_odd_tmp = sesdir + '/b02b0_1_' + str(random.randint(1, 1000)) + '.cnf'
        copyfile(topup_config_odd, topup_config_odd_tmp)
        topup_config = topup_config_odd_tmp
    else:
        topup_config_tmp = sesdir + '/b02b0_' + str(random.randint(1, 1000)) + '.cnf'
        copyfile(topup_config, topup_config_tmp)
        topup_config = topup_config_tmp

    return datain_file_topup, datain_file_eddy, imain_output, example_b0, datain_lines, topup_config, susceptibility_args

sesdir = /Users/derekpisner/Downloads/nki_out/A00032875/ses-ALGA
spec_acqp = 0 -1 0 0.061410
vol_legend = None

Traceback (most recent call last):
  File "/usr/local/anaconda3/lib/python3.7/site-packages/nipype-1.5.0.dev0+g75030b292-py3.7.egg/nipype/pipeline/plugins/multiproc.py", line 67, in run_node
    result["result"] = node.run(updatehash=updatehash)
  File "/usr/local/anaconda3/lib/python3.7/site-packages/nipype-1.5.0.dev0+g75030b292-py3.7.egg/nipype/pipeline/engine/nodes.py", line 516, in run
    result = self._run_interface(execute=True)
  File "/usr/local/anaconda3/lib/python3.7/site-packages/nipype-1.5.0.dev0+g75030b292-py3.7.egg/nipype/pipeline/engine/nodes.py", line 635, in _run_interface
    return self._run_command(execute)
  File "/usr/local/anaconda3/lib/python3.7/site-packages/nipype-1.5.0.dev0+g75030b292-py3.7.egg/nipype/pipeline/engine/nodes.py", line 741, in _run_command
    result = self._interface.run(cwd=outdir)
  File "/usr/local/anaconda3/lib/python3.7/site-packages/nipype-1.5.0.dev0+g75030b292-py3.7.egg/nipype/interfaces/base/core.py", line 394, in run
    runtime = self._run_interface(runtime)
  File "/usr/local/anaconda3/lib/python3.7/site-packages/nipype-1.5.0.dev0+g75030b292-py3.7.egg/nipype/interfaces/utility/wrappers.py", line 142, in _run_interface
    out = function_handle(**args)
  File "<string>", line 49, in topup_inputs_from_dwi_files
AssertionError
